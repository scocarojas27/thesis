{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _Base = _interopRequireDefault(require(\"Base64\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction safeJsonParse(thing) {\n  if ((0, _typeof2.default)(thing) === 'object') return thing;\n\n  try {\n    return JSON.parse(thing);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nfunction padString(string) {\n  var segmentLength = 4;\n  var diff = string.length % segmentLength;\n  if (!diff) return string;\n  var padLength = segmentLength - diff;\n\n  while (padLength--) {\n    string += '=';\n  }\n\n  return string;\n}\n\nfunction toBase64(base64UrlString) {\n  return padString(base64UrlString).replace(/\\-/g, '+') // eslint-disable-line no-useless-escape\n  .replace(/_/g, '/');\n}\n\nfunction decodeBase64Url(base64UrlString) {\n  try {\n    return _Base.default.atob(toBase64(base64UrlString));\n  } catch (e) {\n    if (e.name === 'InvalidCharacterError') {\n      return undefined;\n    }\n\n    throw e;\n  }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(decodeBase64Url(encodedHeader));\n}\n\nfunction JWTScopeToken(apiSecret, resource, action, opts) {\n  /**\n   * Creates the JWT token for feedId, resource and action using the apiSecret\n   * @method JWTScopeToken\n   * @memberof signing\n   * @private\n   * @param {string} apiSecret - API Secret key\n   * @param {string} resource - JWT payload resource\n   * @param {string} action - JWT payload action\n   * @param {object} [options] - Optional additional options\n   * @param {string} [options.feedId] - JWT payload feed identifier\n   * @param {string} [options.userId] - JWT payload user identifier\n   * @return {string} JWT Token\n   */\n  var options = opts || {};\n  var noTimestamp = options.expireTokens ? !options.expireTokens : true;\n  var payload = {\n    resource: resource,\n    action: action\n  };\n\n  if (options.feedId) {\n    payload.feed_id = options.feedId;\n  }\n\n  if (options.userId) {\n    payload.user_id = options.userId;\n  }\n\n  return _jsonwebtoken.default.sign(payload, apiSecret, {\n    algorithm: 'HS256',\n    noTimestamp: noTimestamp\n  });\n}\n\nfunction JWTUserSessionToken(apiSecret, userId) {\n  var extraData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var jwtOptions = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  /**\n   * Creates the JWT token that can be used for a UserSession\n   * @method JWTUserSessionToken\n   * @memberof signing\n   * @private\n   * @param {string} apiSecret - API Secret key\n   * @param {string} userId - The user_id key in the JWT payload\n   * @param {string} [extraData] - Extra that should be part of the JWT token\n   * @param {object} [jwtOptions] - Options that can be past to jwt.sign\n   * @return {string} JWT Token\n   */\n\n  if (typeof userId !== 'string') {\n    throw new TypeError('userId should be a string');\n  }\n\n  var payload = _objectSpread({\n    user_id: userId\n  }, extraData);\n\n  var opts = _objectSpread({\n    algorithm: 'HS256',\n    noTimestamp: true\n  }, jwtOptions);\n\n  return _jsonwebtoken.default.sign(payload, apiSecret, opts);\n}\n\nfunction isJWTSignature(signature) {\n  /**\n   * check if token is a valid JWT token\n   * @method isJWTSignature\n   * @memberof signing\n   * @private\n   * @param {string} signature - Signature to check\n   * @return {boolean}\n   */\n  if (signature == null || signature.length === 0) {\n    return false;\n  }\n\n  var token = signature.split(' ')[1] || signature;\n  return JWS_REGEX.test(token) && !!headerFromJWS(token);\n}\n\nvar _default = {\n  JWTScopeToken: JWTScopeToken,\n  headerFromJWS: headerFromJWS,\n  JWTUserSessionToken: JWTUserSessionToken,\n  isJWTSignature: isJWTSignature,\n  isJWT: isJWTSignature\n};\nexports.default = _default;","map":{"version":3,"sources":["/home/scocarojas/Documents/prototype/front/node_modules/getstream/lib/lib/signing.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","_defineProperty2","_typeof2","_jsonwebtoken","_Base","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","JWS_REGEX","safeJsonParse","thing","JSON","parse","e","undefined","padString","string","segmentLength","diff","padLength","toBase64","base64UrlString","replace","decodeBase64Url","atob","name","headerFromJWS","jwsSig","encodedHeader","split","JWTScopeToken","apiSecret","resource","action","opts","options","noTimestamp","expireTokens","payload","feedId","feed_id","userId","user_id","sign","algorithm","JWTUserSessionToken","extraData","jwtOptions","TypeError","isJWTSignature","signature","token","test","_default","isJWT"],"mappings":"AAAA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAAD,CAApC;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,OAAR,GAAkB,KAAK,CAAvB;;AAEA,IAAIC,gBAAgB,GAAGP,sBAAsB,CAACC,OAAO,CAAC,uCAAD,CAAR,CAA7C;;AAEA,IAAIO,QAAQ,GAAGR,sBAAsB,CAACC,OAAO,CAAC,+BAAD,CAAR,CAArC;;AAEA,IAAIQ,aAAa,GAAGT,sBAAsB,CAACC,OAAO,CAAC,cAAD,CAAR,CAA1C;;AAEA,IAAIS,KAAK,GAAGV,sBAAsB,CAACC,OAAO,CAAC,QAAD,CAAR,CAAlC;;AAEA,SAASU,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AAAE,MAAIC,IAAI,GAAGZ,MAAM,CAACY,IAAP,CAAYF,MAAZ,CAAX;;AAAgC,MAAIV,MAAM,CAACa,qBAAX,EAAkC;AAAE,QAAIC,OAAO,GAAGd,MAAM,CAACa,qBAAP,CAA6BH,MAA7B,CAAd;AAAoD,QAAIC,cAAJ,EAAoBG,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe;AAAE,aAAOhB,MAAM,CAACiB,wBAAP,CAAgCP,MAAhC,EAAwCM,GAAxC,EAA6CE,UAApD;AAAiE,KAAjG,CAAV;AAA8GN,IAAAA,IAAI,CAACO,IAAL,CAAUC,KAAV,CAAgBR,IAAhB,EAAsBE,OAAtB;AAAiC;;AAAC,SAAOF,IAAP;AAAc;;AAErV,SAASS,aAAT,CAAuBC,MAAvB,EAA+B;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;;AAAuD,QAAIA,CAAC,GAAG,CAAR,EAAW;AAAEd,MAAAA,OAAO,CAACT,MAAM,CAAC0B,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAUC,GAAV,EAAe;AAAE,SAAC,GAAGvB,gBAAgB,CAACD,OAArB,EAA8BkB,MAA9B,EAAsCM,GAAtC,EAA2CF,MAAM,CAACE,GAAD,CAAjD;AAA0D,OAAjH;AAAqH,KAAlI,MAAwI,IAAI5B,MAAM,CAAC6B,yBAAX,EAAsC;AAAE7B,MAAAA,MAAM,CAAC8B,gBAAP,CAAwBR,MAAxB,EAAgCtB,MAAM,CAAC6B,yBAAP,CAAiCH,MAAjC,CAAhC;AAA4E,KAApH,MAA0H;AAAEjB,MAAAA,OAAO,CAACT,MAAM,CAAC0B,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAUC,GAAV,EAAe;AAAE5B,QAAAA,MAAM,CAACC,cAAP,CAAsBqB,MAAtB,EAA8BM,GAA9B,EAAmC5B,MAAM,CAACiB,wBAAP,CAAgCS,MAAhC,EAAwCE,GAAxC,CAAnC;AAAmF,OAApI;AAAwI;AAAE;;AAAC,SAAON,MAAP;AAAgB;;AAEpiB,IAAIS,SAAS,GAAG,0DAAhB;;AAEA,SAASC,aAAT,CAAuBC,KAAvB,EAA8B;AAC5B,MAAI,CAAC,GAAG3B,QAAQ,CAACF,OAAb,EAAsB6B,KAAtB,MAAiC,QAArC,EAA+C,OAAOA,KAAP;;AAE/C,MAAI;AACF,WAAOC,IAAI,CAACC,KAAL,CAAWF,KAAX,CAAP;AACD,GAFD,CAEE,OAAOG,CAAP,EAAU;AACV,WAAOC,SAAP;AACD;AACF;;AAED,SAASC,SAAT,CAAmBC,MAAnB,EAA2B;AACzB,MAAIC,aAAa,GAAG,CAApB;AACA,MAAIC,IAAI,GAAGF,MAAM,CAACd,MAAP,GAAgBe,aAA3B;AACA,MAAI,CAACC,IAAL,EAAW,OAAOF,MAAP;AACX,MAAIG,SAAS,GAAGF,aAAa,GAAGC,IAAhC;;AAEA,SAAOC,SAAS,EAAhB,EAAoB;AAClBH,IAAAA,MAAM,IAAI,GAAV;AACD;;AAED,SAAOA,MAAP;AACD;;AAED,SAASI,QAAT,CAAkBC,eAAlB,EAAmC;AACjC,SAAON,SAAS,CAACM,eAAD,CAAT,CAA2BC,OAA3B,CAAmC,KAAnC,EAA0C,GAA1C,EAA+C;AAA/C,GACNA,OADM,CACE,IADF,EACQ,GADR,CAAP;AAED;;AAED,SAASC,eAAT,CAAyBF,eAAzB,EAA0C;AACxC,MAAI;AACF,WAAOpC,KAAK,CAACJ,OAAN,CAAc2C,IAAd,CAAmBJ,QAAQ,CAACC,eAAD,CAA3B,CAAP;AACD,GAFD,CAEE,OAAOR,CAAP,EAAU;AACV,QAAIA,CAAC,CAACY,IAAF,KAAW,uBAAf,EAAwC;AACtC,aAAOX,SAAP;AACD;;AAED,UAAMD,CAAN;AACD;AACF;;AAED,SAASa,aAAT,CAAuBC,MAAvB,EAA+B;AAC7B,MAAIC,aAAa,GAAGD,MAAM,CAACE,KAAP,CAAa,GAAb,EAAkB,CAAlB,EAAqB,CAArB,CAApB;AACA,SAAOpB,aAAa,CAACc,eAAe,CAACK,aAAD,CAAhB,CAApB;AACD;;AAED,SAASE,aAAT,CAAuBC,SAAvB,EAAkCC,QAAlC,EAA4CC,MAA5C,EAAoDC,IAApD,EAA0D;AACxD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE,MAAIC,OAAO,GAAGD,IAAI,IAAI,EAAtB;AACA,MAAIE,WAAW,GAAGD,OAAO,CAACE,YAAR,GAAuB,CAACF,OAAO,CAACE,YAAhC,GAA+C,IAAjE;AACA,MAAIC,OAAO,GAAG;AACZN,IAAAA,QAAQ,EAAEA,QADE;AAEZC,IAAAA,MAAM,EAAEA;AAFI,GAAd;;AAKA,MAAIE,OAAO,CAACI,MAAZ,EAAoB;AAClBD,IAAAA,OAAO,CAACE,OAAR,GAAkBL,OAAO,CAACI,MAA1B;AACD;;AAED,MAAIJ,OAAO,CAACM,MAAZ,EAAoB;AAClBH,IAAAA,OAAO,CAACI,OAAR,GAAkBP,OAAO,CAACM,MAA1B;AACD;;AAED,SAAOzD,aAAa,CAACH,OAAd,CAAsB8D,IAAtB,CAA2BL,OAA3B,EAAoCP,SAApC,EAA+C;AACpDa,IAAAA,SAAS,EAAE,OADyC;AAEpDR,IAAAA,WAAW,EAAEA;AAFuC,GAA/C,CAAP;AAID;;AAED,SAASS,mBAAT,CAA6Bd,SAA7B,EAAwCU,MAAxC,EAAgD;AAC9C,MAAIK,SAAS,GAAG7C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBa,SAAzC,GAAqDb,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAApF;AACA,MAAI8C,UAAU,GAAG9C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBa,SAAzC,GAAqDb,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAArF;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACE,MAAI,OAAOwC,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,UAAM,IAAIO,SAAJ,CAAc,2BAAd,CAAN;AACD;;AAED,MAAIV,OAAO,GAAGxC,aAAa,CAAC;AAC1B4C,IAAAA,OAAO,EAAED;AADiB,GAAD,EAExBK,SAFwB,CAA3B;;AAIA,MAAIZ,IAAI,GAAGpC,aAAa,CAAC;AACvB8C,IAAAA,SAAS,EAAE,OADY;AAEvBR,IAAAA,WAAW,EAAE;AAFU,GAAD,EAGrBW,UAHqB,CAAxB;;AAKA,SAAO/D,aAAa,CAACH,OAAd,CAAsB8D,IAAtB,CAA2BL,OAA3B,EAAoCP,SAApC,EAA+CG,IAA/C,CAAP;AACD;;AAED,SAASe,cAAT,CAAwBC,SAAxB,EAAmC;AACjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACE,MAAIA,SAAS,IAAI,IAAb,IAAqBA,SAAS,CAAChD,MAAV,KAAqB,CAA9C,EAAiD;AAC/C,WAAO,KAAP;AACD;;AAED,MAAIiD,KAAK,GAAGD,SAAS,CAACrB,KAAV,CAAgB,GAAhB,EAAqB,CAArB,KAA2BqB,SAAvC;AACA,SAAO1C,SAAS,CAAC4C,IAAV,CAAeD,KAAf,KAAyB,CAAC,CAACzB,aAAa,CAACyB,KAAD,CAA/C;AACD;;AAED,IAAIE,QAAQ,GAAG;AACbvB,EAAAA,aAAa,EAAEA,aADF;AAEbJ,EAAAA,aAAa,EAAEA,aAFF;AAGbmB,EAAAA,mBAAmB,EAAEA,mBAHR;AAIbI,EAAAA,cAAc,EAAEA,cAJH;AAKbK,EAAAA,KAAK,EAAEL;AALM,CAAf;AAOAtE,OAAO,CAACE,OAAR,GAAkBwE,QAAlB","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _Base = _interopRequireDefault(require(\"Base64\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction safeJsonParse(thing) {\n  if ((0, _typeof2.default)(thing) === 'object') return thing;\n\n  try {\n    return JSON.parse(thing);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nfunction padString(string) {\n  var segmentLength = 4;\n  var diff = string.length % segmentLength;\n  if (!diff) return string;\n  var padLength = segmentLength - diff;\n\n  while (padLength--) {\n    string += '=';\n  }\n\n  return string;\n}\n\nfunction toBase64(base64UrlString) {\n  return padString(base64UrlString).replace(/\\-/g, '+') // eslint-disable-line no-useless-escape\n  .replace(/_/g, '/');\n}\n\nfunction decodeBase64Url(base64UrlString) {\n  try {\n    return _Base.default.atob(toBase64(base64UrlString));\n  } catch (e) {\n    if (e.name === 'InvalidCharacterError') {\n      return undefined;\n    }\n\n    throw e;\n  }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(decodeBase64Url(encodedHeader));\n}\n\nfunction JWTScopeToken(apiSecret, resource, action, opts) {\n  /**\n   * Creates the JWT token for feedId, resource and action using the apiSecret\n   * @method JWTScopeToken\n   * @memberof signing\n   * @private\n   * @param {string} apiSecret - API Secret key\n   * @param {string} resource - JWT payload resource\n   * @param {string} action - JWT payload action\n   * @param {object} [options] - Optional additional options\n   * @param {string} [options.feedId] - JWT payload feed identifier\n   * @param {string} [options.userId] - JWT payload user identifier\n   * @return {string} JWT Token\n   */\n  var options = opts || {};\n  var noTimestamp = options.expireTokens ? !options.expireTokens : true;\n  var payload = {\n    resource: resource,\n    action: action\n  };\n\n  if (options.feedId) {\n    payload.feed_id = options.feedId;\n  }\n\n  if (options.userId) {\n    payload.user_id = options.userId;\n  }\n\n  return _jsonwebtoken.default.sign(payload, apiSecret, {\n    algorithm: 'HS256',\n    noTimestamp: noTimestamp\n  });\n}\n\nfunction JWTUserSessionToken(apiSecret, userId) {\n  var extraData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var jwtOptions = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  /**\n   * Creates the JWT token that can be used for a UserSession\n   * @method JWTUserSessionToken\n   * @memberof signing\n   * @private\n   * @param {string} apiSecret - API Secret key\n   * @param {string} userId - The user_id key in the JWT payload\n   * @param {string} [extraData] - Extra that should be part of the JWT token\n   * @param {object} [jwtOptions] - Options that can be past to jwt.sign\n   * @return {string} JWT Token\n   */\n  if (typeof userId !== 'string') {\n    throw new TypeError('userId should be a string');\n  }\n\n  var payload = _objectSpread({\n    user_id: userId\n  }, extraData);\n\n  var opts = _objectSpread({\n    algorithm: 'HS256',\n    noTimestamp: true\n  }, jwtOptions);\n\n  return _jsonwebtoken.default.sign(payload, apiSecret, opts);\n}\n\nfunction isJWTSignature(signature) {\n  /**\n   * check if token is a valid JWT token\n   * @method isJWTSignature\n   * @memberof signing\n   * @private\n   * @param {string} signature - Signature to check\n   * @return {boolean}\n   */\n  if (signature == null || signature.length === 0) {\n    return false;\n  }\n\n  var token = signature.split(' ')[1] || signature;\n  return JWS_REGEX.test(token) && !!headerFromJWS(token);\n}\n\nvar _default = {\n  JWTScopeToken: JWTScopeToken,\n  headerFromJWS: headerFromJWS,\n  JWTUserSessionToken: JWTUserSessionToken,\n  isJWTSignature: isJWTSignature,\n  isJWT: isJWTSignature\n};\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}