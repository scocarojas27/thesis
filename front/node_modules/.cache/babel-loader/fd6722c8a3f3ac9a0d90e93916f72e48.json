{"ast":null,"code":"import \"core-js/modules/es6.array.sort\"; // Copyright 2018 Twitter, Inc.\n// Licensed under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n/**\n * Copied from https://github.com/twitter/twitter-text/blob/master/js/twitter-text.js\n */\n\nvar convertUnicodeIndices = function convertUnicodeIndices(text, entities, indicesInUTF16) {\n  if (entities.length === 0) {\n    return;\n  }\n\n  var charIndex = 0;\n  var codePointIndex = 0; // sort entities by start index\n\n  entities.sort(function (a, b) {\n    return a.indices[0] - b.indices[0];\n  });\n  var entityIndex = 0;\n  var entity = entities[0];\n\n  while (charIndex < text.length) {\n    if (entity.indices[0] === (indicesInUTF16 ? charIndex : codePointIndex)) {\n      var len = entity.indices[1] - entity.indices[0];\n      entity.indices[0] = indicesInUTF16 ? codePointIndex : charIndex;\n      entity.indices[1] = entity.indices[0] + len;\n      entityIndex++;\n\n      if (entityIndex === entities.length) {\n        // no more entity\n        break;\n      }\n\n      entity = entities[entityIndex];\n    }\n\n    var c = text.charCodeAt(charIndex);\n\n    if (c >= 0xd800 && c <= 0xdbff && charIndex < text.length - 1) {\n      // Found high surrogate char\n      c = text.charCodeAt(charIndex + 1);\n\n      if (c >= 0xdc00 && c <= 0xdfff) {\n        // Found surrogate pair\n        charIndex++;\n      }\n    }\n\n    codePointIndex++;\n    charIndex++;\n  }\n};\n\nexport default convertUnicodeIndices;","map":{"version":3,"sources":["/home/scocarojas/Documents/prototype/node_modules/twitter-text/dist/esm/lib/convertUnicodeIndices.js"],"names":["convertUnicodeIndices","text","entities","indicesInUTF16","length","charIndex","codePointIndex","sort","a","b","indices","entityIndex","entity","len","c","charCodeAt"],"mappings":"AAAA,OAAO,gCAAP,C,CAEA;AACA;AACA;;AAEA;AACA;AACA;;AACA,IAAIA,qBAAqB,GAAG,SAASA,qBAAT,CAA+BC,IAA/B,EAAqCC,QAArC,EAA+CC,cAA/C,EAA+D;AACzF,MAAID,QAAQ,CAACE,MAAT,KAAoB,CAAxB,EAA2B;AACzB;AACD;;AAED,MAAIC,SAAS,GAAG,CAAhB;AACA,MAAIC,cAAc,GAAG,CAArB,CANyF,CAMjE;;AAExBJ,EAAAA,QAAQ,CAACK,IAAT,CAAc,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC5B,WAAOD,CAAC,CAACE,OAAF,CAAU,CAAV,IAAeD,CAAC,CAACC,OAAF,CAAU,CAAV,CAAtB;AACD,GAFD;AAGA,MAAIC,WAAW,GAAG,CAAlB;AACA,MAAIC,MAAM,GAAGV,QAAQ,CAAC,CAAD,CAArB;;AAEA,SAAOG,SAAS,GAAGJ,IAAI,CAACG,MAAxB,EAAgC;AAC9B,QAAIQ,MAAM,CAACF,OAAP,CAAe,CAAf,OAAuBP,cAAc,GAAGE,SAAH,GAAeC,cAApD,CAAJ,EAAyE;AACvE,UAAIO,GAAG,GAAGD,MAAM,CAACF,OAAP,CAAe,CAAf,IAAoBE,MAAM,CAACF,OAAP,CAAe,CAAf,CAA9B;AACAE,MAAAA,MAAM,CAACF,OAAP,CAAe,CAAf,IAAoBP,cAAc,GAAGG,cAAH,GAAoBD,SAAtD;AACAO,MAAAA,MAAM,CAACF,OAAP,CAAe,CAAf,IAAoBE,MAAM,CAACF,OAAP,CAAe,CAAf,IAAoBG,GAAxC;AACAF,MAAAA,WAAW;;AAEX,UAAIA,WAAW,KAAKT,QAAQ,CAACE,MAA7B,EAAqC;AACnC;AACA;AACD;;AAEDQ,MAAAA,MAAM,GAAGV,QAAQ,CAACS,WAAD,CAAjB;AACD;;AAED,QAAIG,CAAC,GAAGb,IAAI,CAACc,UAAL,CAAgBV,SAAhB,CAAR;;AAEA,QAAIS,CAAC,IAAI,MAAL,IAAeA,CAAC,IAAI,MAApB,IAA8BT,SAAS,GAAGJ,IAAI,CAACG,MAAL,GAAc,CAA5D,EAA+D;AAC7D;AACAU,MAAAA,CAAC,GAAGb,IAAI,CAACc,UAAL,CAAgBV,SAAS,GAAG,CAA5B,CAAJ;;AAEA,UAAIS,CAAC,IAAI,MAAL,IAAeA,CAAC,IAAI,MAAxB,EAAgC;AAC9B;AACAT,QAAAA,SAAS;AACV;AACF;;AAEDC,IAAAA,cAAc;AACdD,IAAAA,SAAS;AACV;AACF,CA5CD;;AA8CA,eAAeL,qBAAf","sourcesContent":["import \"core-js/modules/es6.array.sort\";\n\n// Copyright 2018 Twitter, Inc.\n// Licensed under the Apache License, Version 2.0\n// http://www.apache.org/licenses/LICENSE-2.0\n\n/**\n * Copied from https://github.com/twitter/twitter-text/blob/master/js/twitter-text.js\n */\nvar convertUnicodeIndices = function convertUnicodeIndices(text, entities, indicesInUTF16) {\n  if (entities.length === 0) {\n    return;\n  }\n\n  var charIndex = 0;\n  var codePointIndex = 0; // sort entities by start index\n\n  entities.sort(function (a, b) {\n    return a.indices[0] - b.indices[0];\n  });\n  var entityIndex = 0;\n  var entity = entities[0];\n\n  while (charIndex < text.length) {\n    if (entity.indices[0] === (indicesInUTF16 ? charIndex : codePointIndex)) {\n      var len = entity.indices[1] - entity.indices[0];\n      entity.indices[0] = indicesInUTF16 ? codePointIndex : charIndex;\n      entity.indices[1] = entity.indices[0] + len;\n      entityIndex++;\n\n      if (entityIndex === entities.length) {\n        // no more entity\n        break;\n      }\n\n      entity = entities[entityIndex];\n    }\n\n    var c = text.charCodeAt(charIndex);\n\n    if (c >= 0xd800 && c <= 0xdbff && charIndex < text.length - 1) {\n      // Found high surrogate char\n      c = text.charCodeAt(charIndex + 1);\n\n      if (c >= 0xdc00 && c <= 0xdfff) {\n        // Found surrogate pair\n        charIndex++;\n      }\n    }\n\n    codePointIndex++;\n    charIndex++;\n  }\n};\n\nexport default convertUnicodeIndices;"]},"metadata":{},"sourceType":"module"}