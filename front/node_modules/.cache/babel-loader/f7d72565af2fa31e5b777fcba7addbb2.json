{"ast":null,"code":"var validate = require('validate.js'),\n    specs = require('./specs.js'),\n    errors = require('./errors.js'),\n    Client = require('./client.js');\n\nvar StreamAnalytics = function (config) {\n  this.configure(config || {});\n};\n\nStreamAnalytics.prototype.configure = function (cfg) {\n  this.client = new Client(cfg);\n  this.userData = null;\n};\n\nStreamAnalytics.prototype.setUser = function (userData) {\n  this.userData = userData;\n};\n\nStreamAnalytics.prototype._sendEventFactory = function (resourceName, dataSpec) {\n  // snakeCase\n  return function (eventData) {\n    var validationErrors = validate(eventData, dataSpec, {\n      format: 'flat'\n    });\n\n    if (typeof validationErrors !== 'undefined') {\n      throw new errors.InvalidInputData('event data is not valid', validationErrors);\n    }\n\n    return this._sendEvent(resourceName, eventData);\n  };\n};\n\nStreamAnalytics.prototype._sendEvent = function (resourceName, eventData) {\n  if (this.userData === null) {\n    throw new errors.MissingUserId('userData was not set');\n  }\n\n  eventData['user_data'] = this.userData;\n  return this.client.send(resourceName, eventData);\n};\n\nStreamAnalytics.prototype.trackImpression = StreamAnalytics.prototype._sendEventFactory('impression', specs.impressionSpec);\nStreamAnalytics.prototype.trackEngagement = StreamAnalytics.prototype._sendEventFactory('engagement', specs.engagementSpec);\nStreamAnalytics.Client = Client;\nStreamAnalytics.errors = errors;\nif (typeof window !== 'undefined') require('./async.js')(StreamAnalytics);\nmodule.exports = StreamAnalytics;","map":{"version":3,"sources":["/home/scocarojas/Documents/prototype/front/node_modules/stream-analytics/src/stream-analytics.js"],"names":["validate","require","specs","errors","Client","StreamAnalytics","config","configure","prototype","cfg","client","userData","setUser","_sendEventFactory","resourceName","dataSpec","eventData","validationErrors","format","InvalidInputData","_sendEvent","MissingUserId","send","trackImpression","impressionSpec","trackEngagement","engagementSpec","window","module","exports"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,aAAD,CAAtB;AAAA,IACEC,KAAK,GAAGD,OAAO,CAAC,YAAD,CADjB;AAAA,IAEEE,MAAM,GAAGF,OAAO,CAAC,aAAD,CAFlB;AAAA,IAGEG,MAAM,GAAGH,OAAO,CAAC,aAAD,CAHlB;;AAKA,IAAII,eAAe,GAAG,UAAUC,MAAV,EAAkB;AACtC,OAAKC,SAAL,CAAeD,MAAM,IAAI,EAAzB;AACD,CAFD;;AAIAD,eAAe,CAACG,SAAhB,CAA0BD,SAA1B,GAAsC,UAAUE,GAAV,EAAe;AACnD,OAAKC,MAAL,GAAc,IAAIN,MAAJ,CAAWK,GAAX,CAAd;AACA,OAAKE,QAAL,GAAgB,IAAhB;AACD,CAHD;;AAKAN,eAAe,CAACG,SAAhB,CAA0BI,OAA1B,GAAoC,UAAUD,QAAV,EAAoB;AACtD,OAAKA,QAAL,GAAgBA,QAAhB;AACD,CAFD;;AAIAN,eAAe,CAACG,SAAhB,CAA0BK,iBAA1B,GAA8C,UAAUC,YAAV,EAAwBC,QAAxB,EAAkC;AAC9E;AACA,SAAO,UAAUC,SAAV,EAAqB;AAC1B,QAAIC,gBAAgB,GAAGjB,QAAQ,CAACgB,SAAD,EAAYD,QAAZ,EAAsB;AAAEG,MAAAA,MAAM,EAAE;AAAV,KAAtB,CAA/B;;AACA,QAAI,OAAQD,gBAAR,KAA8B,WAAlC,EAA+C;AAC7C,YAAM,IAAId,MAAM,CAACgB,gBAAX,CAA4B,yBAA5B,EAAuDF,gBAAvD,CAAN;AACD;;AAED,WAAO,KAAKG,UAAL,CAAgBN,YAAhB,EAA8BE,SAA9B,CAAP;AACD,GAPD;AAQD,CAVD;;AAYAX,eAAe,CAACG,SAAhB,CAA0BY,UAA1B,GAAuC,UAAUN,YAAV,EAAwBE,SAAxB,EAAmC;AACxE,MAAI,KAAKL,QAAL,KAAkB,IAAtB,EAA4B;AAC1B,UAAM,IAAIR,MAAM,CAACkB,aAAX,CAAyB,sBAAzB,CAAN;AACD;;AAEDL,EAAAA,SAAS,CAAC,WAAD,CAAT,GAAyB,KAAKL,QAA9B;AACA,SAAO,KAAKD,MAAL,CAAYY,IAAZ,CAAiBR,YAAjB,EAA+BE,SAA/B,CAAP;AACD,CAPD;;AASAX,eAAe,CAACG,SAAhB,CAA0Be,eAA1B,GACElB,eAAe,CAACG,SAAhB,CAA0BK,iBAA1B,CACE,YADF,EAEEX,KAAK,CAACsB,cAFR,CADF;AAKAnB,eAAe,CAACG,SAAhB,CAA0BiB,eAA1B,GACEpB,eAAe,CAACG,SAAhB,CAA0BK,iBAA1B,CACE,YADF,EAEEX,KAAK,CAACwB,cAFR,CADF;AAMArB,eAAe,CAACD,MAAhB,GAAyBA,MAAzB;AACAC,eAAe,CAACF,MAAhB,GAAyBA,MAAzB;AAEA,IAAI,OAAQwB,MAAR,KAAoB,WAAxB,EACE1B,OAAO,CAAC,YAAD,CAAP,CAAsBI,eAAtB;AAEFuB,MAAM,CAACC,OAAP,GAAiBxB,eAAjB","sourcesContent":["var validate = require('validate.js'),\n  specs = require('./specs.js'),\n  errors = require('./errors.js'),\n  Client = require('./client.js');\n\nvar StreamAnalytics = function (config) {\n  this.configure(config || {});\n};\n\nStreamAnalytics.prototype.configure = function (cfg) {\n  this.client = new Client(cfg);\n  this.userData = null;\n};\n\nStreamAnalytics.prototype.setUser = function (userData) {\n  this.userData = userData;\n};\n\nStreamAnalytics.prototype._sendEventFactory = function (resourceName, dataSpec) {\n  // snakeCase\n  return function (eventData) {\n    var validationErrors = validate(eventData, dataSpec, { format: 'flat' });\n    if (typeof (validationErrors) !== 'undefined') {\n      throw new errors.InvalidInputData('event data is not valid', validationErrors);\n    }\n\n    return this._sendEvent(resourceName, eventData);\n  };\n};\n\nStreamAnalytics.prototype._sendEvent = function (resourceName, eventData) {\n  if (this.userData === null) {\n    throw new errors.MissingUserId('userData was not set');\n  }\n\n  eventData['user_data'] = this.userData;\n  return this.client.send(resourceName, eventData);\n};\n\nStreamAnalytics.prototype.trackImpression =\n  StreamAnalytics.prototype._sendEventFactory(\n    'impression',\n    specs.impressionSpec\n  );\nStreamAnalytics.prototype.trackEngagement =\n  StreamAnalytics.prototype._sendEventFactory(\n    'engagement',\n    specs.engagementSpec\n  );\n\nStreamAnalytics.Client = Client;\nStreamAnalytics.errors = errors;\n\nif (typeof (window) !== 'undefined')\n  require('./async.js')(StreamAnalytics);\n\nmodule.exports = StreamAnalytics;\n"]},"metadata":{},"sourceType":"script"}